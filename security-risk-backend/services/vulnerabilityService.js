const Vulnerability = require('../models/Vulnerability');

async function getAllVulnerabilities(filter = {}) {
  return await Vulnerability.find(filter);
}

async function getVulnerabilityById(id) {
  return await Vulnerability.findById(id);
}

async function createVulnerability(data) {
  const vuln = new Vulnerability(data);
  return await vuln.save();
}

async function updateVulnerability(id, data) {
  return await Vulnerability.findByIdAndUpdate(id, data, { new: true });
}

async function deleteVulnerability(id) {
  return await Vulnerability.findByIdAndDelete(id);
}

module.exports = {
  getAllVulnerabilities,
  getVulnerabilityById,
  createVulnerability,
  updateVulnerability,
  deleteVulnerability
};
