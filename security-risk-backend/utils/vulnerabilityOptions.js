module.exports.VULNERABILITY_OPTIONS = {
"Phần cứng": [
      { code: "VH01", description: "Bảo trì không đầy đủ/lắp đặt phương tiện lưu trữ không đúng cách" },
      { code: "VH02", description: "Thiếu kế hoạch thay thế định kỳ cho thiết bị" },
      { code: "VH03", description: "Dễ bị ảnh hưởng bởi độ ẩm, bụi, bẩn" },
      { code: "VH04", description: "Nhạy cảm với bức xạ điện từ" },
      { code: "VH05", description: "Kiểm soát thay đổi cấu hình không đầy đủ" },
      { code: "VH06", description: "Dễ bị ảnh hưởng bởi biến động điện áp" },
      { code: "VH07", description: "Dễ bị ảnh hưởng bởi biến động nhiệt độ" },
      { code: "VH08", description: "Lưu trữ không được bảo vệ" },
      { code: "VH09", description: "Thiếu cẩn trọng khi xử lý thiết bị thải bỏ" },
      { code: "VH10", description: "Sao chép không kiểm soát" }
    ],
    "Phần mềm": [
      { code: "VS01", description: "Kiểm thử phần mềm không đầy đủ hoặc không có" },
      { code: "VS02", description: "Lỗi phổ biến trong phần mềm" },
      { code: "VS03", description: "Không đăng xuất khi rời khỏi máy trạm" },
      { code: "VS04", description: "Xử lý hoặc tái sử dụng phương tiện lưu trữ mà không xóa đúng cách" },
      { code: "VS05", description: "Cấu hình nhật ký không đầy đủ cho mục đích kiểm tra" },
      { code: "VS06", description: "Phân quyền truy cập sai" },
      { code: "VS07", description: "Phần mềm phân phối rộng rãi" },
      { code: "VS08", description: "Áp dụng chương trình ứng dụng cho dữ liệu sai về mặt thời gian" },
      { code: "VS09", description: "Giao diện người dùng phức tạp" },
      { code: "VS10", description: "Thiếu hoặc không có tài liệu hướng dẫn" },
      { code: "VS11", description: "Cài đặt tham số không đúng" },
      { code: "VS12", description: "Ngày tháng không chính xác" },
      { code: "VS13", description: "Cơ chế nhận diện/xác thực không đầy đủ (ví dụ xác thực người dùng)" },
      { code: "VS14", description: "Bảng mật khẩu không được bảo vệ" },
      { code: "VS15", description: "Quản lý mật khẩu kém" },
      { code: "VS16", description: "Kích hoạt dịch vụ không cần thiết" },
      { code: "VS17", description: "Phần mềm mới hoặc chưa hoàn thiện" },
      { code: "VS18", description: "Đặc tả cho lập trình viên không rõ ràng hoặc không đầy đủ" },
      { code: "VS19", description: "Quản lý thay đổi không hiệu quả" },
      { code: "VS20", description: "Tải xuống và sử dụng phần mềm không kiểm soát" },
      { code: "VS21", description: "Sao lưu không đầy đủ hoặc không có" },
      { code: "VS22", description: "Không tạo được báo cáo quản lý" }
    ],
    "Mạng": [
      { code: "VN01", description: "Cơ chế xác nhận gửi/nhận thông điệp không đầy đủ" },
      { code: "VN02", description: "Đường truyền thông tin không được bảo vệ" },
      { code: "VN03", description: "Lưu lượng nhạy cảm không được bảo vệ" },
      { code: "VN04", description: "Cáp nối kém" },
      { code: "VN05", description: "Điểm lỗi đơn" },
      { code: "VN06", description: "Cơ chế xác thực/nhận diện người gửi và nhận không đầy đủ" },
      { code: "VN07", description: "Kiến trúc mạng không an toàn" },
      { code: "VN08", description: "Truyền mật khẩu dưới dạng rõ" },
      { code: "VN09", description: "Quản lý mạng không đầy đủ (khả năng phục hồi định tuyến)" },
      { code: "VN10", description: "Kết nối mạng công cộng không được bảo vệ" }
    ],
    "Nhân sự": [
      { code: "VP01", description: "Thiếu nhân sự" },
      { code: "VP02", description: "Quy trình tuyển dụng không đầy đủ" },
      { code: "VP03", description: "Đào tạo an ninh không đầy đủ" },
      { code: "VP04", description: "Sử dụng phần mềm và phần cứng không đúng cách" },
      { code: "VP05", description: "Nhận thức về an ninh kém" },
      { code: "VP06", description: "Thiếu hoặc không có cơ chế giám sát" },
      { code: "VP07", description: "Công việc không được giám sát bởi nhân viên ngoài hoặc nhân viên vệ sinh" },
      { code: "VP08", description: "Chính sách/lỗi trong sử dụng phương tiện truyền thông và nhắn tin" }
    ],
    "Địa điểm": [
      { code: "VS01", description: "Kiểm soát truy cập vật lý tới tòa nhà/phòng không đầy đủ hoặc bất cẩn" },
      { code: "VS02", description: "Vị trí ở khu vực dễ bị ngập lụt" },
      { code: "VS03", description: "Lưới điện không ổn định" },
      { code: "VS04", description: "Bảo vệ vật lý cho tòa nhà, cửa ra vào và cửa sổ không đầy đủ" }
    ],
    "Tổ chức": [
      { code: "V001", description: "Quy trình đăng ký/hủy đăng ký người dùng không đầy đủ hoặc không hiệu quả" },
      { code: "V002", description: "Quy trình kiểm tra quyền truy cập không đầy đủ hoặc không hiệu quả" },
      { code: "V003", description: "Quy định về bảo mật trong hợp đồng với khách hàng/bên thứ ba không đầy đủ" },
      { code: "V004", description: "Giám sát xử lý thông tin không đầy đủ hoặc không hiệu quả" },
      { code: "V005", description: "Kiểm tra (giám sát) không được thực hiện thường xuyên" },
      { code: "V006", description: "Quy trình nhận diện và đánh giá rủi ro không đầy đủ hoặc không hiệu quả" },
      { code: "V007", description: "Không ghi nhận hoặc thiếu báo cáo lỗi trong nhật ký quản trị/nhật ký vận hành" },
      { code: "V008", description: "Phản hồi bảo trì dịch vụ không đầy đủ" },
      { code: "V009", description: "Thiếu hoặc không có Thỏa thuận mức dịch vụ (SLA)" },
      { code: "V010", description: "Quy trình kiểm soát thay đổi không đầy đủ hoặc không hiệu quả" },
      { code: "V011", description: "Quy trình kiểm soát tài liệu ISMS không đầy đủ hoặc không hiệu quả" },
      { code: "V012", description: "Quy trình kiểm soát hồ sơ ISMS không đầy đủ hoặc không hiệu quả" },
      { code: "V013", description: "Quy trình phê duyệt thông tin công khai không đầy đủ hoặc không hiệu quả" },
      { code: "V014", description: "Phân bổ trách nhiệm an ninh thông tin không hợp lý" },
      { code: "V015", description: "Kế hoạch liên tục không tồn tại, không đầy đủ hoặc đã lỗi thời" },
      { code: "V016", description: "Chính sách sử dụng email không đầy đủ hoặc không hiệu quả" },
      { code: "V017", description: "Quy trình đưa phần mềm vào hệ thống không đầy đủ hoặc không hiệu quả" },
      { code: "V018", description: "Quy trình xử lý thông tin mật không đầy đủ hoặc không hiệu quả" },
      { code: "V019", description: "Trách nhiệm an ninh thông tin không được ghi rõ trong mô tả công việc" },
      { code: "V020", description: "Quy định về bảo mật trong hợp đồng với nhân viên không đầy đủ" },
      { code: "V021", description: "Quy trình xử lý sự cố an ninh thông tin không đầy đủ hoặc không hiệu quả" },
      { code: "V022", description: "Chính sách sử dụng thiết bị di động không đầy đủ hoặc không hiệu quả" },
      { code: "V023", description: "Kiểm soát tài sản ngoài cơ sở không đầy đủ" },
      { code: "V024", description: "Thiếu hoặc không có chính sách 'bàn làm việc sạch sẽ, màn hình sạch sẽ'" },
      { code: "V025", description: "Ủy quyền truy cập cơ sở xử lý thông tin không được thực hiện hoặc không hoạt động đúng" },
      { code: "V026", description: "Cơ chế giám sát vi phạm an ninh không được triển khai đúng" },
      { code: "V027", description: "Quy trình báo cáo điểm yếu an ninh không được phát triển hoặc không hiệu quả" },
      { code: "V028", description: "Quy trình tuân thủ quyền sở hữu trí tuệ không được phát triển hoặc không hiệu quả" }
    ],
    "Khác": []
  };

  function isValidVulnerability(category, code, description) {
    const options = module.exports.VULNERABILITY_OPTIONS[category];
    if (!options) return false;
    if (category === "Khác") return !!description;
    return options.some(item => item.code === code && item.description === description);
  }
  
  module.exports.isValidVulnerability = isValidVulnerability;