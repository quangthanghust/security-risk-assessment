const mongoose = require('mongoose');

const vulnerabilitySchema = new mongoose.Schema({
  category: {
    type: String,
    enum: [
      'Phần cứng', 'Phần mềm', 'Mạng', 'Nhân sự', 'Địa điểm', 'Tổ chức', 'Khác'
    ],
    required: true
  },
  code: { type: String }, // VD: VH01, VS01, ...
  description: { type: String, required: true },
  vulnerabilityLevel: { type: Number, min: 1, max: 5, required: true },
  asset: { type: mongoose.Schema.Types.ObjectId, ref: 'Asset' }, // Liên kết tài sản bị ảnh hưởng
  isCustom: { type: Boolean, default: false },
  createdBy: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: true }
}, { timestamps: true });

module.exports = mongoose.model('Vulnerability', vulnerabilitySchema);